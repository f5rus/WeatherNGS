
Описание к тестовому заданию.

При разработке данного приложения использовал:
- операционная система windows ;
- веб-сервер apache ;
- язык программирования PHP для бэкенда;
- база данных MongoDB;
- язык программирования JS для фронтэнда;
- D3.js для построения графиков.

ФРОНТЕНД.

В  script.js реализованы функции:

•	Получения данных с сервера, по средством ajax- запросов.

•	Загрузка гугл-карты и размещения на ней маркеров с текущей погодой.

•	 Построение графиков  температуры за последние сутки.


ПОСЛЕДОВАТЕЛЬНОСТЬ ВЫПОЛНЕНИЯ ЗАДАЧ ПРИ ЗАГРУЗКЕ СТРАНИЦЫ:

1.	На странице загружается гугл-карта.

2.	Выполняется ajax-запрос на сервер для получения списка городов с координатами для  установки маркеров на карте. Полученные данные городов сохраняются в массив.

3.	Выполняется ajax-запрос на сервер для получения текущей погоды по всем городам имеющимся в базе данных. Данные о текущей погоде сохраняются в массив.

4.	Устанавливаются маркеры на гугл-карту с текущей температурой по городам.

5.	Устанавливается обработчик события 'click' на маркеры.

ПРИ КЛИКЕ НА МАРКЕР ВЫПОЛНЯЮТСЯ СЛЕДУЮЩИЕ ДЕЙСТВИЯ:

1.	Отправляется ajax запрос на сервер, для получения всей погоды за последние сутки.

2.	Данные о погоде сохраняются в массив. В массиве также сохраняется дата последних полученных сведений. При следующем ajax-запросе эта дата отправляется в параметрах на сервер, откуда возвращаются уже не все данные за сутки, а только свежие.

3.	Появляется балун с текущей температурой, давлением, влажностью.

4.	Рисуется график температуры за последние сутки, на основе данных из массива.


БЭКЕНД.

ajax.php

Скрипт обрабатывает ajax запросы от клиента. Имеется 3 действия:

	getCities - возвращает массив городов
	
	getForecastArchiv - возвращает массив с погодой начиная с указанной даты по одному городу
	
	getForecastCurrent - возвращает массив с текущую погодой по всем городам.
	

PogodaNgs.class.php

Функции получения данных о погоде с http://pogoda.ngs.ru/json/ реализованы в классе PogodaNgs. Получение данных осуществляется при помощи функции file_get_contents. Имеются 2  метода:

	getForecasts($names,$cities) - возвращает погоду по нескольким городам.
	
	getForecast ($name, $city) - возвращает погоду по одному городу.
	
Forecast.class.php

В классе Forecast реализованы статические методы для получения погоды из базы данных, а  так же запись данных о погоде в базу данных, полученных с http://pogoda.ngs.ru/json/. 

Имеются 3 метода:

	request() - запрашивает текущую погоду с http://pogoda.ngs.ru/json/ по средством   класса PogodaNgs описанного выше. Сохраняет сведения в базу данных.
	
	getForecastCurrent() - возвращает из базы данных последние сведения о погоде по 
всем городам которые имеются в базе. 

 	getForecastArchiv($сity, $lastUpdate='') - возвращает из базы данных сведения о погоде позднее указанной в параметрах даты, для указанного в параметре города. Если дата в параметрах не указана, из базы данных выбираются данные за последние сутки.
 	
Cities.class.php

Класс Cities реализован для работы с таблицей городов бызы данных. Данная таблица содержит наименования городов, долготу и широту необходимую для установки маркеров по городам на карте. Имеются 3 функции:

	getCitiesName() - возвращает массив с наименованиями городов. Используется в параметрах при получения данных с  http://pogoda.ngs.ru/json/.
	
	getCities()-возвращает список городов из базы данных.
	
	setCity() - позволяет добавить в бд новый город с наименованием и координатами для карты.
DB.class.php

Класс DB служит для создания и управления подключениями субд mongo. Реализация 
паттерна-проектирования singleton.

ForecastDocument.class.php

	Класс  ForecastDocument  реализован для работы с таблицей погоды базы данных. 
Имеет функции сохранения данных с базу, валидации данных.

Request.php
Данный скрипт необходимо поместить в планировщик задач. В данном скрипте реализован вызов метода, который получает данный с погода НГС и сохраняет в базу данных.
